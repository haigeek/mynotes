# linux常用命令（文件查找、文件下载、文件压缩、用户、权限）

## 文件查找命令

### which

查看可执行文件的位置

### whereis

查看文件的位置

### find

实际搜寻硬盘查询文件名称

```
find / -name Redis-x64-3.2.100.zip
```



## 文件下载

### wget

安装wget工具：yum install wget

命令格式：wget 参数 下载地址

使用wget -h 可以查看命令使用帮助

示例：

1. **使用wget下载单个文件**

```
wget http://www.minjieren.com/wordpress-3.1-zh_CN.zip
```

以下的例子是从网络下载一个文件并保存在当前目录，在下载的过程中会显示进度条，包含（下载完成百分比，已经下载的字节，当前下载速度，剩余下载时间）。默认的下载地址为当前的目录

2. **使用wget -O下载并以不同的文件名保存**

```
wget -O wordpress.zip http://www.minjieren.com/download.aspx?id=1080
```

> wget默认会以最后一个符合”/”的后面的字符来命令，对于动态链接的下载通常文件名会不正确。

错误：下面的例子会下载一个文件并以名称download.aspx?id=1080保存

```
wget http://www.minjieren.com/download?id=1
```

即使下载的文件是zip格式，它仍然以download.php?id=1080命令。

正确：为了解决这个问题，我们可以使用参数-O来指定一个文件名：

3. **使用wget -c断点续传**

```
wget -c http://www.minjieren.com/wordpress-3.1-zh_CN.zip
```

使用wget -c重新启动下载中断的文件，对于我们下载大文件时突然由于网络等原因中断非常有帮助，我们可以继续接着下载而不是重新下载一个文件。需要继续中断的下载时可以使用-c参数

4. **使用wget -b后台下载**

对于下载非常大的文件的时候，我们可以使用参数-b进行后台下载。

```
wget -b http://www.minjieren.com/wordpress-3.1-zh_CN.zip
```

你可以使用以下命令来察看下载进度：

```
tail -f wget-log
```

5. **伪装代理名称下载**

```
wget --user-agent="Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Chrome/10.0.648.204 Safari/534.16" http://www.minjieren.com/wordpress-3.1-zh_CN.zip
```

有些网站能通过根据判断代理名称不是浏览器而拒绝你的下载请求。不过你可以通过–user-agent参数伪装。

6. **使用wget –tries增加重试次数**

```
wget --tries=40 URL
```

7. **使用wget -i下载多个文件**

```
wget -i filelist.txt
```

首先，保存一份下载链接文件

```
cat > filelist.txt

url1

url2

url3

url4

```

接着使用这个文件和参数-i下载

8. **使用wget -o把下载信息存入日志文件**

```
wget -o download.log URL
```

不希望下载信息直接显示在终端而是在一个日志文件，可以使用

9. **使用wget FTP下载**

```
wget ftp-url

wget --ftp-user=USERNAME --ftp-password=PASSWORD url
```

可以使用wget来完成ftp链接的下载。

使用wget匿名ftp下载：

```
wget ftp-url
```

使用wget用户名和密码认证的ftp下载

```
wget --ftp-user=USERNAME --ftp-password=PASSWORD url
```

### tar

Linux中很多压缩程序只能针对一个文件进行压缩，这样当你想要压缩一大堆文件时，你得先将这一大堆文件先打成一个包（tar命令），然后再用压缩程序进行压缩（gzip bzip2命令）。

linux下最常用的打包程序就是tar了，使用tar程序打出来的包我们常称为tar包，tar包文件的命令通常都是以.tar结尾的。生成tar包后，就可以用其它的程序来进行压缩。

1．**命令格式**：

tar 必要参数 选择参数 文件 

2．**命令功能**：

用来压缩和解压文件。tar本身不具有压缩功能。他是调用压缩功能实现的 

3．**命令参数：**

**必要参数有如下：**

-A 新增压缩文件到已存在的压缩

-B 设置区块大小

-c 建立新的压缩文件

-d 记录文件的差别

-r 添加文件到已经压缩的文件

-u 添加改变了和现有的文件到已经存在的压缩文件

-x 从压缩的文件中提取文件

-t 显示压缩文件的内容

-z 支持gzip解压文件

-j 支持bzip2解压文件

-Z 支持compress解压文件

-v 显示操作过程

-l 文件系统边界设置

-k 保留原有文件不覆盖

-m 保留文件不被覆盖

-W 确认压缩文件的正确性

**可选参数如下：**

-b 设置区块数目

-C 切换到指定目录

-f 指定压缩文件

--help 显示帮助信息

--version 显示版本信息

4. **示例**

   1. 将文件打包成tar包

   ```
   tar -cvf hello.tar hello.txt
   ```

   2. 将文件打包并以gzip格式进行压缩，这里我们指定了.gz 那么系统会调用gzip程序对文件进行压缩

   ```
   tar -zcvf hello.tar.gz hello.txt
   ```

   3. 将tar包进行解压缩

   ```
   tar -zxvf hello.tar.gz
   ```

## 用户与用户组管理

Linux是一个多用户、多任务的操作系统

### 用户管理

查看本机用户信息 /etc/passwd

#### useradd

1．**命令格式**：

useradd 选项 用户名

2．**命令功能**：

添加新的用户账号

3．**命令参数：**

-d 指定用户的主目录

-m 如果此目录不存在，则同时使用-m选项，可以创建主目录。

-g 用户组 指定用户所属的用户组。

-G  用户组，用户组 指定用户所属的附加组。

-s Shell文件 指定用户的登录Shell。

-c comment 指定一段注释性描述

4. **示例**

```
useradd -d /usr/sam -m sam
```

此命令创建了一个用户sam，其中-d和-m选项用来为登录名sam产生一个主目录/usr/sam（/usr为默认的用户主目录所在的父目录）

```
useradd -d /usr/haigeek -m -s /bin/sh -g users -G adm,root haigeek
```

此命令新建了一个用户haigeek，该用户的登录Shell是 `/bin/sh`，它属于users用户组，同时又属于adm和root用户组，其中group用户组是其主组。

#### usermod

1. **命令格式**：

usermod 选项 用户名

2. **命令功能**：

修改用户账号

3. **命令参数：**

-d 指定用户的主目录

-m 如果此目录不存在，则同时使用-m选项，可以创建主目录。

-g 用户组 指定用户所属的用户组。

-G  用户组，用户组 指定用户所属的附加组。

-s Shell文件 指定用户的登录Shell。

-c comment 指定一段注释性描述

4. **示例**

```
usermod -s /bin/ksh -d /user/newsam –g users sam
```

修改用户登录的shell和组

```
usermod -l sam1 sam
```

修改sam的登录名为sam1

#### passwd

1. **命令格式**：

passwd 选项 用户名

2. **命令功能**：

为用户设置密码，新建的用户加入不设置密码的话是无法登录的

3. **命令参数：**

-l 锁定口令，即禁用账号。

-u 口令解锁。

-d 使账号无口令。

-f 强迫用户下次登录时修改口令。

4. **示例**

```
passwd
```

当前用户可以自行进行密码的修改

```
pass sam
```

修改指定用户的密码

```
passwd -l sam
```

锁定用户

```
passwd -u sam
```

解锁用户

#### userdel

1．**命令格式**：

userdel 选项 用户名

2．**命令功能**：

删除用户账号

3．**命令参数：**

-r 把用户的主目录一起删除

4. 示例

```
userdel -r sam
```

### 用户组管理

查看查询的用户组 /etc/group，查看当前用户所在的组 切换到用户 使用groups查看

#### groupadd

1. **命令格式**：

groupadd 选项 组名

2. **命令功能**：

添加用户组

3. **命令参数：**

-g GID 指定新用户组的组标识号（GID

4. **示例**

```
groupadd group1
```

此命令向系统中增加了一个新组group1，新组的组标识号是在当前已有的最大组标识号的基础上加1。

```
groupadd -g 101 group2
```

此命令向系统中增加了一个新组group2，同时指定新组的组标识号是101。

#### groupdel

1. **命令格式**：

groupdel 选项 组名

2. **命令功能**：

删除用户组

3. **示例**

```
groupdel group1
```

#### groupmod

1. **命令格式**：

groupmod 选项 组名

2. **命令功能**：

修改用户组

3. **命令参数：**

-g GID 为用户组指定新的组标识号

-o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。

-n新用户组 将用户组的名字改为新名字

4. **示例**

```
groupmod -g 102 group2
```

此命令将组group2的组标识号修改为102

```
groupmod –g 10000 -n group3 group2
```

此命令将组group2的标识号改为10000，组名修改为group3。

### 文件权限设置

　文件或目录的访问权限分为只读，只写和可执行三种。以文件为例，只读权限表示只允许读其内容，而禁止对其做任何的更改操作。可执行权限表示允许将该文件作为一个程序执行。**文件被创建时，文件所有者自动拥有对该文件的读、写和可执行权限，以便于对文件的阅读和修改。**用户也可根据需要把访问权限设置为需要的任何组合。
　　有三种不同类型的用户可对文件或目录进行访问：**文件所有者，同组用户、其他用户**。所有者一般是文件的创建者。所有者可以允许同组用户有权访问文件，还可以将文件的访问权限赋予系统中的其他用户。在这种情况下，系统中每一位用户都能访问该用户拥有的文件或目录。

#### chmod

1. **命令格式**：

chmod 必要参数 选择参数 文件名

2. **命令功能**：

chown改变某个文件或者目录的所有着和所有组，该命令有两种用法。一种是包含字母和操作符表达式的文字设定法；另一种是包含数字的数字设定法。

3. **命令参数：**

**必要参数**：
-c 当发生改变时，报告处理信息
-f 错误信息不输出
-R 处理指定目录以及其子目录下的所有文件
-v 运行时显示详细处理信息

**选择参数**：
--reference=<目录或者文件> 设置成具有指定目录或者文件具有相同的权限
--version 显示版本信息
<权限范围>+<权限设置> 使权限范围内的目录或者文件具有指定的权限
<权限范围>-<权限设置> 删除权限范围的目录或者文件的指定权限
<权限范围>=<权限设置> 设置权限范围内的目录或者文件的权限为指定的值

**权限范围**：
u ：目录或者文件的当前的用户
g ：目录或者文件的当前的群组
o ：除了目录或者文件的当前用户或群组之外的用户或者群组
a ：所有的用户及群组

**权限代号**：

r ：读权限，用数字4表示
w ：写权限，用数字2表示
x ：执行权限，用数字1表示
\- ：删除权限，用数字0表示
s ：特殊权限 常见参数：

4. 示例

```
chmod a+x hello.txt
```

增加文件所有用户组的可执行权限

```
chmod ug+w,o+x hello.txt
```

使目录当前的用户和组具有写权限，其他的用户和组具有可执行权限

```
chmod a-x hello.txt
```

删除文件所有用户组的可执行权限

```
chmod u=x hello.txt
```

撤销原来所有的权限，然后使拥有者具有可执行权限 

```
chmod -R u+x hello
```

递归地给test4目录下所有文件和子目录的属主分配权限 

```
chmod 751 file   
```

给file的属主分配读、写、执行(7)的权限，给file的所在组分配读、执行(5)的权限，给其他用户分配执行(1)的权限

```
chmod u=rwx,g=rx,o=x file 
```

上例的另一种形式

#### chown

chown将指定文件的拥有者改为指定的用户或组，用户可以是用户名或者用户ID；组可以是组名或者组ID；文件是以空格分开的要改变权限的文件列表，支持通配符。系统管理员经常使用chown命令，在将文件拷贝到另一个用户的名录下之后，让用户拥有使用该文件的权限。 

1. **命令格式**：

chown 参数 用户 :用户组 文件名

2. **命令功能**：

通过chown改变文件的拥有者和群组。在更改文件的所有者或所属群组时，可以使用用户名称和用户识别码设置。普通用户不能将自己的文件改变成其他的拥有者。其操作权限一般为管理员。

3. **命令参数：**

　　　　-c 显示更改的部分的信息

　　　　-f 忽略错误信息

　　　　-R 处理指定目录以及其子目录下的所有文件

　　　　-v 显示详细的处理信息

　**选择参数:**

　　　　--reference=<目录或文件> 把指定的目录/文件作为参考，把操作的文件/目录设置成参考文件/目录相同拥有者和群组

　　　　--from=<当前用户：当前群组> 只有当前用户和群组跟指定的用户和群组相同时才进行改变

　　　　--help 显示帮助信息

　　　　--version 显示版本信息

4. **示例**

```
chown haigeek:users hello.tar
```

改变拥有者和组

```
chown root  hello.tar
```

改变拥有者

```
chown :root hello.tar
```

改变拥有组

```
chown -R -v haigeek:users /opt/test
```

改变指定目录以及其子目录下的所有文件的拥有者和群组 



