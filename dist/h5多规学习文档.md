h5多规代码熟悉
# 专题解决方案的配置(运维层面)与权限(后台)的获取
## 专题信息的获取
- 接口 
  /rest/privilege/v1/allTopics/guid

- 主要实现方法

  实现层：PrivilegeController

  PrivilegeService层包含了用户所具有的工具、容器、专题等数据，获取专题的方法为getAllTopics，获取方式为先获取一级标题再获取一级专题的子级专题，专题的数据主要通过TopicDTO来进行数据的传输。

- 存储过程

- 运维配置(用户授权)

# 综合台账功能的具体实现(什么是基础台账和高级台账？在实现上有和不同)

基础台账和高级台账的判断依据是传输数据中的 type 空表示高级台账,任何参数表示基础台账。

- 接口 

  /rest/tz/v1/gjtz

- 主要实现方法

  - findJCTZList(tzParam.getKey(), tzParam.getFirstRegion(), tzParam.getSecondRegion())
  - findGJTZList(tzParam.getKey(), tzParam.getDicKey(), tzParam.getFirstRegion(), tzParam.getSecondRegion())

  1. 查询台账第一步需要获取台账的表名，很根据dicName（基础台账、高级台账）获取台账数据表名，查询数据库的key-value表，这一步在dao层查询的时候使用的hibernate的一对多

### 普通台账

#### 数据的获取

从数据库取出来的数据是根据groupby已经进行了分组的数据

#### 数据的计算

普通的台账先计算出总的面积、然后计算比例，最后加上合集

#### 数据的排序

在运维中配置名称顺序，根据字典进行排序，创建一个以名称为key的datamap

核心方法：dataMap.get(dicValue.getValue())

### 高级台账

#### 台账数据的获取

获取台账的物化视图和dic_ydxz_level进行连表查询（物化视图的fldm对他dic_ydxz_level的fcode）

其中传输的dictype对应dic_ydxz_level的type

台账dto中的id对应fcode、parentid对应pid、根据fsort进行排序

#### 台账的计算

##### 计算流程

1、拿到获取到的台账数据是具有级联的关系；创建一个以id为key的datamap，创建一个储存结果的list

2、 获取根节点（没有parentid）计算合计数据添加到list，这一组list为一级节点的id集合（A、B...)

3、对这个list进行遍历，调用递归的方法initTree

4、递归进行处理。递归的方法参数有：节点id、包含所有台账dto的map

##### 递归方法

1、拿到根结点的list

2、以根结点为起始点，开始获取这个这个节点的子节点，将他与他的子节点关联起来

3、计算当前节点的面积

4、继续初始化子节点的子节点，直到没有自己子节点，开始获取这个节点的数据并计算比例

5、递归一层计算一次数据并计算比例

# 工具与容器的配置，权限管理
## 根据用户编码进行界面的获取
- 接口 
/rest/privilege/v1/allTopics/guid
- 主要实现方法
- 存储过程
- 运维配置(用户授权)