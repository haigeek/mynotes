# 外网成果下载方案

## 方案1、直接在应用系统进行下载（不推荐）

### 实现路径

直接以文件流的形式将数据从应用系统进行返回，客户端进行下载。

### 此方案的劣势

1. 对于大文件来说，传输不稳定，中断后需要重新下载

2. 占用应用系统出口带宽

## 方案2、使用独立静态资源服务器进行文件下载

### 总体实现路径：

1. 先将数据从momgo数据库抽取组织成文件包的形式储存在服务器制定目录上，例如 z:/成果导出（目前的实现形式）
2. 新增一个Tomcat（用作静态资源下载），开放一个端口。并将z:/成果导出映射为Tomcat的根目录，这样直接请求新的Tomcat上的额成果包进行文件下载（例如：http://127.0.0.1/file/xxxx/xx省成果包）直接进行下载

### 最佳实现路径

在上述实现的基础上，新增一台服务器专门作为下载服务器，可以开辟80端口，使用外网系统的子域名（例如http://dl.kjghssjd.mnr.gov.cn/）从应用系统点击下载后，会去此下载服务器请求数据进行下载。

### 使用此方案的优势

1. 下载服务与应用服务隔离，下载资源的时候会对带宽有较大的需求，假如直接从应用系统进行下载成果包，当出现并行下载的情况时，会占用系统的出口带宽，可能会导致系统无法正常响应
2. 静态资源服务器原生支持断点下载，当客户端中断文件下载的时候，可以从暂停的地方继续下载。同时支持下载进度的展示，下载功能与应用系统隔离可以避免对应用系统的侵入

